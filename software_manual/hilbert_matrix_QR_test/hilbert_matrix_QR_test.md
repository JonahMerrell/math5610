# Software Manual (hilbert_matrix_QR_test.py)

## [Back](../softwaremanual)

**Routine Name:**           hilbert_matrix_QR_test.py

**Author:** Jonah Merrell

**Language:** Python 3.7.0

**Description/Purpose:** This routine tests the QR factorization method on various hilbert matrices.

**Input:** There are no inputs needed in this case. 
		   
**Output:** This routine merely tests the "matrix_QR_factorization" method on the hilbert matric for various sizes, and returns the
 reults as a string.

**Usage/Example:**

Below shows an example of running
 "hilbert_matrix_QR_test". 

      hilbert_matrix_QR_test()

Output from the lines above:

      Given a 4-sized Hilbert matrix, its Q matrix is:
      [0.8381163549234938, -0.522648373955656, 0.15397276151572545, -0.026306682083019617]
      [0.4190581774617469, 0.44171332392052864, -0.7277538073653712, 0.31568018503294154]
      [0.27937211830783126, 0.5288213862464716, 0.13950552217863885, -0.7892004626413147]
      [0.20952908873087345, 0.5020716663196072, 0.6536092057629643, 0.5261336417889331]
      Q^t*Q should result in the identity matrix:
      [0.9999999999997305, 2.3097808388161667e-12, -4.264293779199235e-12, 2.1124230836777613e-12]
      [2.3097808388161667e-12, 0.9999999999837089, 2.2206042560313222e-11, -5.935085756192393e-12]
      [-4.264293779199235e-12, 2.2206042560313222e-11, 0.9999999999910445, -1.6193713037182533e-11]
      [2.1124230836777613e-12, -5.935085756192393e-12, -1.6193713037182533e-11, 1.0000000000255156]
      
      Given a 6-sized Hilbert matrix, its Q matrix is:
      [0.8188503677432238, -0.5396805063287359, 0.1892605368134778, -0.048236093937807506, 0.00902960575628944, -0.0011054090691209612]
      [0.4094251838716119, 0.33198790152534996, -0.702416981042382, 0.4489264728489745, -0.16165259942801324, 0.033157435855955236]
      [0.2729501225810746, 0.4219346525801395, -0.15293340631966573, -0.5723225555206813, 0.5853903082753577, -0.23207622778449216]
      [0.20471259193580596, 0.4067252126385623, 0.20151310598660432, -0.38664006490100855, -0.4686850146194891, 0.6188160605349792]
      [0.16377007354864478, 0.37352642248602713, 0.39626058927476543, 0.09151694945188091, -0.42854071116067527, -0.6961194911777525]
      [0.1364750612905373, 0.33993050229500926, 0.499772168776025, 0.5574220141290118, 0.47727592254833695, 0.2784319023423218]
      Q^t*Q should result in the identity matrix:
      [1.0000000009270804, -2.2600722653628514e-08, 1.3014722956381387e-07, -2.8819180564307236e-07, 2.709361657572424e-07, -9.089155999066414e-08]
      [-2.2600722653628514e-08, 1.0000005196831994, -2.7882469136892435e-06, 5.657049807400449e-06, -4.757317350476825e-06, 1.3762926205414944e-06]
      [1.3014722956381387e-07, -2.7882469136892435e-06, 1.0000135433166037, -2.3629566318184025e-05, 1.5313444477277338e-05, -2.434846226362364e-06]
      [-2.8819180564307236e-07, 5.657049807400449e-06, -2.3629566318184025e-05, 1.0000296752688858, -3.3190182096021204e-06, -8.512147080808052e-06]
      [2.709361657572424e-07, -4.757317350476825e-06, 1.5313444477277338e-05, -3.3190182096021204e-06, 0.9999699190543714, 2.3094179043281482e-05]
      [-9.089155999066414e-08, 1.3762926205414944e-06, -2.434846226362364e-06, -8.512147080808052e-06, 2.3094179043281482e-05, 0.9999863417498595]

      Given a 8-sized Hilbert matrix, its Q matrix is:
      [0.8091340392542118, -0.5466547599242865, 0.20639227283776787, -0.06047527992883863, 0.014414255758815596, -0.00277657706135675, 2.9948575470202627e-05, -8.111720666201335e-06]
      [0.4045670196271059, 0.2825300459356618, -0.67656985422179, 0.4933554561020644, -0.22360672484460545, 0.07135314701931396, -0.005989404194448713, 0.005415546062860367]
      [0.2697113464180706, 0.3736391725897096, -0.24128994356688016, -0.4273677375730479, 0.6135054998531776, -0.3854611186655468, 0.08799329290068365, -0.08480614695585542]
      [0.20228350981355295, 0.3636079933269531, 0.054326610824638556, -0.4518667438577538, -0.11089585050681162, 0.5920188431732877, -0.3854141803594962, 0.38023624028404385]
      [0.16182680785084236, 0.33535498873338676, 0.22262901541707794, -0.21243804795069218, -0.4481338469899241, 0.07578318359257942, 0.5801049472665011, -0.5802264522058577]
      [0.1348556732090353, 0.3059318918443844, 0.3161348309579637, 0.05794064483370086, -0.3359677632920015, -0.44275999163428376, -0.014604394674217699, 0.018526750825920688]
      [0.11559057703631596, 0.27924337951654815, 0.3669182999837771, 0.2932154145666545, 0.029151236668568985, -0.33177791113890476, -0.6166441708281654, 0.6183471976402402]
      [0.10114175490677647, 0.25591832011651716, 0.39287312945476877, 0.4813045556075668, 0.4965453619124201, 0.4289269762185834, 0.35593839989465126, -0.3589425547954681]
      Q^t*Q should result in the identity matrix:
      [0.999999830909302, 6.487712925491505e-06, -5.7386451768337945e-05, 0.00018889951278389068, -0.0002355170327719059, 7.044564626669947e-06, 0.00019328235543657397, -0.0001028262358130422]
      [6.487712925491505e-06, 0.9998005140207906, 0.001411786666146212, -0.0037121972687639043, 0.003782483547875882, -0.0005887174699643749, -0.001077447764025739, 0.0003700243096367902]
      [-5.7386451768337945e-05, 0.001411786666146212, 0.9931186361749808, 0.008025457621201298, 0.0021273758960367317, 0.01133054630471261, -0.03926041445440406, 0.023469179333221346]
      [0.00018889951278389068, -0.0037121972687639043, 0.008025457621201298, 1.0361722151814383, -0.08688152263067311, -0.08268010072107647, 0.2854862205261573, -0.15742744285952506]
      [-0.0002355170327719059, 0.003782483547875882, 0.0021273758960367317, -0.08688152263067311, 1.1130960083461232, 0.2802740099185947, -0.6229587130479286, 0.3121447507910888]
      [7.044564626669947e-06, -0.0005887174699643749, 0.01133054630471261, -0.08268010072107647, 0.2802740099185947, 0.524546001716099, 0.391568034077782, -0.12456215120248859]
      [0.00019328235543657397, -0.001077447764025739, -0.03926041445440406, 0.2854862205261573, -0.6229587130479286, 0.391568034077782, 1.1854720318707872, -0.20083926120387005]
      [-0.0001028262358130422, 0.0003700243096367902, 0.023469179333221346, -0.15742744285952506, 0.3121447507910888, -0.12456215120248859, -0.20083926120387005, 1.1477947617804793]
      
      Given a 10-sized Hilbert matrix, its Q matrix is:
      [0.8032795172207581, -0.5503303087509742, 0.21648104642533067, -0.06828314366757689, 0.01826753133008237, -0.004188918548104572, 0.0010215009148745896, 0.0009770121423959787, 0.000948235609864081, 0.0009178625383140775]
      [0.40163975861037904, 0.25441718080738795, -0.6576786147300748, 0.5136199900826577, -0.25922167238809163, 0.0976859667150777, -0.03362767688290201, -0.03257088973088024, -0.03187614149871291, -0.03113450821646675]
      [0.267759839073586, 0.34613889893255045, -0.2808542079272217, -0.3399364873229746, 0.5976597931956289, -0.44988961150452467, 0.24258439783342584, 0.23757321077525775, 0.23416822029803458, 0.23044433831800049]
      [0.20081987930518952, 0.33904152447684416, -0.015850090731523353, -0.4411014335702737, 0.057402974509528734, 0.47106733376513554, -0.5721246694228646, -0.5662187134059199, -0.5616789986198029, -0.5562892258773952]
      [0.16065590344415162, 0.3135998063961052, 0.13839732385728826, -0.29741762707790553, -0.3150825835278451, 0.3096123975850883, 0.26986438715095223, 0.27164241687122787, 0.271611552272227, 0.2705769252843983]
      [0.133879919536793, 0.28655137843403417, 0.22632468517204118, -0.10801526763371097, -0.38628658362444485, -0.12883572992631206, 0.41616403164582444, 0.41546634041108294, 0.41531224674036304, 0.41538045499661497]
      [0.11475421674582258, 0.26182717136742345, 0.27587888439591934, 0.06581216712068672, -0.263811650903944, -0.3765778555696751, -0.0069905539834670535, -0.009814490727754855, -0.010733154995473136, -0.010911234362963158]
      [0.10040993965259476, 0.24013174026280537, 0.30285698411561623, 0.20940417365330619, -0.04607166073574406, -0.32887765169039107, -0.3789264083148552, -0.38303981797769154, -0.3858525660210065, -0.38891309003500113]
      [0.08925327969119534, 0.2212961000140919, 0.3162498047483888, 0.32296912658259375, 0.20562583847839702, -0.027459731915796638, -0.3007673065969867, -0.302728604160072, -0.3050092838893223, -0.3082795629860651]
      [0.08032795172207581, 0.20494375185104127, 0.3213134789004016, 0.4108402110534303, 0.4576926505001556, 0.4505007207322663, 0.364115306297124, 0.37017726008054386, 0.3746729178419526, 0.37987626084826265]
      Q^t*Q should result in the identity matrix:
      [1.0000030520656449, -0.00010055130207684223, 0.0007233812201619457, -0.0016872643718966467, 0.000731373075470106, 0.0013049990092617687, 3.831574563646752e-05, -0.0011786352829341795, -0.0009857577327796, 0.0011552252287851399]
      [-0.00010055130207684223, 1.0033048051102298, -0.023688632665662245, 0.054822982805180304, -0.022553356771595354, -0.04380215836705094, -0.0020980954404484476, 0.039236385018444814, 0.03335165496798637, -0.038609145849691794]
      [0.0007233812201619457, -0.023688632665662245, 1.168768830251836, -0.38512384502534747, 0.14215189554391716, 0.3279158088649537, 0.02419502997384355, -0.2887134948062615, -0.2502097259305195, 0.2849644003300882]
      [-0.0016872643718966467, 0.054822982805180304, -0.38512384502534747, 1.84817028283191, -0.21593702984673432, -0.8524536790097281, -0.09246942860920866, 0.7135928861995305, 0.6306427244070524, -0.701897690865982]
      [0.000731373075470106, -0.022553356771595354, 0.14215189554391716, -0.21593702984673432, 0.7205041911316993, 0.7070045696208609, 0.07526126645548416, -0.4325789272277161, -0.37149979395396343, 0.3980917539996081]
      [0.0013049990092617687, -0.04380215836705094, 0.3279158088649537, -0.8524536790097281, 0.7070045696208609, 1.0195716224277276, 0.28016655734219514, -0.45028570930560274, -0.4695107191079107, 0.4817115621868157]
      [3.831574563646752e-05, -0.0020980954404484476, 0.02419502997384355, -0.09246942860920866, 0.07526126645548416, 0.28016655734219514, 0.37394931430671235, 0.3225241328890764, 0.1444907782559336, -0.1261783567339966]
      [-0.0011786352829341795, 0.039236385018444814, -0.2887134948062615, 0.7135928861995305, -0.4325789272277161, -0.45028570930560274, 0.3225241328890764, 0.904041296518395, 0.6925774044237063, -0.5006962617405678]
      [-0.0009857577327796, 0.03335165496798637, -0.2502097259305195, 0.6306427244070524, -0.37149979395396343, -0.4695107191079107, 0.1444907782559336, 0.6925774044237063, 0.6744696625806983, -0.08439440999999731]
      [0.0011552252287851399, -0.038609145849691794, 0.2849644003300882, -0.701897690865982, 0.3980917539996081, 0.4817115621868157, -0.1261783567339966, -0.5006962617405678, -0.08439440999999731, 1.2872169427751472]


The 4 sections above each print 2 matrices. The first matrix simply prints the resulting "Q" matrix from QR factorization from the hilbert matrix of corresponding size. 
The second matrix printed in each section above shows the result of Q^t*Q. In theory, this value should be the identity matrix. However, we can see from the examples above
 that a large amount of error is accumulated during the computation process, so that by the time the "identity matrix" is acheived, many of the values in the matrix arent accurate to even a single significant figure.
 This is especially true for larger matrices. The largest matrix tested above is a 10 by 10 hilbert matrix, and it has accumlated the most error by far.

**Implementation/Code:** The following is the code for hilbert_matrix_QR_test()


      import sys, os
      sys.path.append(os.path.abspath('../../mylibrary'))
      from _mymodules import vector_dot, vector_scal_mult, vector_add, vector_2norm, matrix_mult, matrix_transpose
      
      def matrix_QR_factorization(matrix):
      
          matrix_columns = [[matrix[i][j] for i in range(len(matrix))] for j in range(len(matrix[0]))]
          u_vectors = []
          for i in range(len(matrix[0])):
              u_vectors.append(matrix_columns[i])
              for j in range(i):
                  u_vectors[i] = vector_add(u_vectors[i],vector_scal_mult(-1*vector_dot(matrix_columns[i],u_vectors[j]),u_vectors[j]))
              u_vectors[i] = vector_scal_mult(1/vector_2norm(u_vectors[i]),u_vectors[i])
      
          matrix_Q = [[u_vectors[i][j] for i in range(len(u_vectors))] for j in range(len(u_vectors[0]))]
          matrix_R = matrix_mult(matrix_transpose(matrix_Q),matrix)
      
          return [matrix_Q,matrix_R]

